{"version":3,"names":["h","useMemo","FileItem","VirtualList","chunks","list","size","chunked","currentChunk","forEach","item","length","push","id","error","i18n","uppy","files","acquirers","resumableUploads","hideRetryButton","hidePauseResumeButton","hideCancelButton","showLinkToFileUploadResult","showRemoveButtonAfterComplete","isWide","metaFields","isSingleFile","toggleFileCard","handleRequestThumbnail","handleCancelThumbnail","recoveredState","individualCancellation","itemsPerRow","openFileEditor","canEditFile","toggleAddFilesPanel","containerWidth","containerHeight","rowHeight","rows","sortByGhostComesFirst","file1","file2","isGhost","fileIds","Object","keys","sort","renderRow","row","map","fileID"],"sources":["FileList.jsx"],"sourcesContent":["import { h } from 'preact'\nimport { useMemo } from 'preact/hooks'\nimport FileItem from './FileItem/index.jsx'\nimport VirtualList from './VirtualList.jsx'\n\nfunction chunks (list, size) {\n  const chunked = []\n  let currentChunk = []\n  list.forEach((item) => {\n    if (currentChunk.length < size) {\n      currentChunk.push(item)\n    } else {\n      chunked.push(currentChunk)\n      currentChunk = [item]\n    }\n  })\n  if (currentChunk.length) chunked.push(currentChunk)\n  return chunked\n}\n\nexport default ({\n  id, error, i18n, uppy, files, acquirers, resumableUploads, hideRetryButton, hidePauseResumeButton, hideCancelButton,\n  showLinkToFileUploadResult, showRemoveButtonAfterComplete, isWide, metaFields, isSingleFile, toggleFileCard,\n  handleRequestThumbnail, handleCancelThumbnail, recoveredState, individualCancellation, itemsPerRow, openFileEditor,\n  canEditFile, toggleAddFilesPanel, containerWidth, containerHeight,\n}) => {\n  // It's not great that this is hardcoded!\n  // It's ESPECIALLY not great that this is checking against `itemsPerRow`!\n  const rowHeight = itemsPerRow === 1\n    // Mobile\n    ? 71\n    // 190px height + 2 * 5px margin\n    : 200\n\n  // Sort files by file.isGhost, ghost files first, only if recoveredState is present\n  const rows = useMemo(() => {\n    const sortByGhostComesFirst = (file1, file2) => files[file2].isGhost - files[file1].isGhost\n\n    const fileIds = Object.keys(files)\n    if (recoveredState) fileIds.sort(sortByGhostComesFirst)\n    return chunks(fileIds, itemsPerRow)\n  }, [files, itemsPerRow, recoveredState])\n\n  const renderRow = (row) => (\n    // The `role=\"presentation` attribute ensures that the list items are properly\n    // associated with the `VirtualList` element.\n    // We use the first file ID as the keyâ€”this should not change across scroll rerenders\n    <div class=\"uppy-Dashboard-filesInner\" role=\"presentation\" key={row[0]}>\n      {row.map((fileID) => (\n        <FileItem\n          key={fileID}\n          uppy={uppy}\n          // FIXME This is confusing, it's actually the Dashboard's plugin ID\n          id={id}\n          error={error}\n          // TODO move this to context\n          i18n={i18n}\n          // features\n          acquirers={acquirers}\n          resumableUploads={resumableUploads}\n          individualCancellation={individualCancellation}\n          // visual options\n          hideRetryButton={hideRetryButton}\n          hidePauseResumeButton={hidePauseResumeButton}\n          hideCancelButton={hideCancelButton}\n          showLinkToFileUploadResult={showLinkToFileUploadResult}\n          showRemoveButtonAfterComplete={showRemoveButtonAfterComplete}\n          isWide={isWide}\n          metaFields={metaFields}\n          recoveredState={recoveredState}\n          isSingleFile={isSingleFile}\n          containerWidth={containerWidth}\n          containerHeight={containerHeight}\n          // callbacks\n          toggleFileCard={toggleFileCard}\n          handleRequestThumbnail={handleRequestThumbnail}\n          handleCancelThumbnail={handleCancelThumbnail}\n          role=\"listitem\"\n          openFileEditor={openFileEditor}\n          canEditFile={canEditFile}\n          toggleAddFilesPanel={toggleAddFilesPanel}\n          file={files[fileID]}\n        />\n      ))}\n    </div>\n  )\n\n  if (isSingleFile) {\n    return (\n      <div class=\"uppy-Dashboard-files\">\n        {renderRow(rows[0])}\n      </div>\n    )\n  }\n\n  return (\n    <VirtualList\n      class=\"uppy-Dashboard-files\"\n      role=\"list\"\n      data={rows}\n      renderRow={renderRow}\n      rowHeight={rowHeight}\n    />\n  )\n}\n"],"mappings":"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"}